SELECT
    p.Product_ID,
    p.Product_Name,
    pr.Part_ID,
    pr.Part_Description,
    SUM(bi.Quantity * ppo.Quantity_Ordered) AS Quantity_Required
FROM
    Production_Order po
JOIN
    Customer_Order co ON po.Customer_Order_ID = co.Customer_Order_ID
JOIN
    Customer_Order_Product cop ON co.Customer_Order_ID = cop.Customer_Order_ID
JOIN
    Product p ON cop.Product_ID = p.Product_ID
JOIN
    Product_Production_Order ppo ON p.Product_ID = ppo.Product_ID AND po.Order_ID = ppo.Production_Order_ID
JOIN
    BOO b ON p.Product_ID = b.Product_ID
JOIN
    BOO_Input bi ON b.Product_ID = bi.Product_ID AND b.Operation_ID = bi.Operation_ID
JOIN
    Part pr ON bi.Part_ID = pr.Part_ID
WHERE
    po.Order_ID = 1001
GROUP BY
    p.Product_ID,
    p.Product_Name,
    pr.Part_ID,
    pr.Part_Description
ORDER BY
    p.Product_Name,
    pr.Part_Description;
