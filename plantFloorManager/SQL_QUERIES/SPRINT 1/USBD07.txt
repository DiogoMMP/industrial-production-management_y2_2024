SELECT
    po.Order_ID,
    bp.Part_ID AS Component_Part_ID,
    p.Product_Name,
    SUM(bp.Part_Quantity * ppo.Quantity_Ordered) AS Quantity_To_Order
FROM
    Product_Production_Order ppo
JOIN
    Production_Order po ON ppo.Production_Order_ID = po.Order_ID
JOIN
    BOM_Part bp ON ppo.Product_ID = bp.Product_ID
JOIN
    Product p ON ppo.Product_ID = p.Product_ID
LEFT JOIN
    Component c ON bp.Part_ID = c.Part_ID
WHERE
    po.Order_ID = 1001
GROUP BY
    po.Order_ID,
    bp.Part_ID,
    p.Product_Name
ORDER BY
    po.Order_ID,
    bp.Part_ID;