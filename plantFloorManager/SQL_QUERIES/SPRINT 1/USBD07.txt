SELECT
    bp.Part_ID AS Part_ID,
    pt.Part_Type AS Part_Type,
    SUM(bp.Part_Quantity * ppo.Quantity_Ordered) AS Quantity_To_Order
FROM
    Product_Production_Order ppo
JOIN
    Production_Order po ON ppo.Production_Order_ID = po.Order_ID
JOIN
    BOM_Part bp ON ppo.Product_ID = bp.Product_ID
JOIN
    Part pt ON bp.Part_ID = pt.Part_ID
LEFT JOIN
    Component c ON bp.Part_ID = c.Part_ID
WHERE
    po.Order_ID = 1001
GROUP BY
    bp.Part_ID,
    pt.Part_Type
ORDER BY
    bp.Part_ID;
